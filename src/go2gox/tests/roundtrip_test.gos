(package
  main
  (import "testing")
  (func roundTripTestChans
        (#(t (ptr testing.T)))
        &void
        (:= bio (make (chan &int) 4))
        (:= bo (make (chan<-! &int) 4))
        (:= bi (make (chan<- &int) 4))
        (<-! bio 1)
        (<-! bo 2)
        (fmt.Printf "%d" (<- bi))
        (fmt.Printf "%d" (<- bio)))
  (func roundTripTestCase
        (#(t (ptr testing.T)))
        &void
        (case! (index os.Args 0)
               (("/bin/sh") (print "What!"))
               (("/bin/bash") (print "Realy?"))
               (else (print "Wow"))))
  (func roundTripTestCond
        (#(t (ptr testing.T)))
        &void
        (cond! ((== t %nil) (print "Unlikely"))
               (else (print "Probably"))))
  (func roundTripTestComm
        (#(t (ptr testing.T)))
        &void
        (:= io (make (chan &int) 4))
        (comm! ((<-! io 5) (print "sent"))
               ((:= one (<- io)) (print "recv"))
               (else (<-! io 1)))))
